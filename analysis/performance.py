import time
from neo4j import GraphDatabase
from concurrent.futures import ThreadPoolExecutor


primary_uri = "bolt://localhost:7617"
cluster_uri = "neo4j://localhost:7617"
user = "neo4j"
password = "secret123"


class Neo4jConnector:
    def __init__(self, uri, user, password):
        self.uri = uri
        self.user = user
        self.password = password
        self.driver = GraphDatabase.driver(uri, auth=(user, password), encrypted=False, database="neo4j")

    def close(self):
        self.driver.close()

    def run(self, query, parameters=None):
        with self.driver.session() as session:
            result = session.run(query, parameters or {})
            return result

    def list_databases(self):
        query = "SHOW DATABASES"
        with self.driver.session() as session:
            result = session.run(query)
            res = [record["name"] for record in result]
            print(res)
            return res


def run(connector, query):
    connector.run(query)


def test_query_performance():
    def generate_person_queries():
        person_ids = ['nm001000', 'nm001001', 'nm001002', 'nm001003', 'nm001004', 'nm001005', 'nm001006', 'nm001007', 'nm001008', 'nm001009', 'nm001010', 'nm001011', 'nm001012', 'nm001013', 'nm001014', 'nm001015', 'nm001016', 'nm001017', 'nm001018', 'nm001019', 'nm001020', 'nm001021', 'nm001022', 'nm001023', 'nm001024', 'nm001025', 'nm001026', 'nm001027', 'nm001028', 'nm001029', 'nm001030', 'nm001031', 'nm001032', 'nm001033', 'nm001034', 'nm001035', 'nm001036', 'nm001037', 'nm001038', 'nm001039', 'nm001040', 'nm001041', 'nm001042', 'nm001043', 'nm001044', 'nm001045', 'nm001046', 'nm001047', 'nm001048', 'nm001049', 'nm001050', 'nm001051', 'nm001052', 'nm001053', 'nm001054', 'nm001055', 'nm001056', 'nm001057', 'nm001058', 'nm001059', 'nm001060', 'nm001061', 'nm001062', 'nm001063', 'nm001064', 'nm001065', 'nm001066', 'nm001067', 'nm001068', 'nm001069', 'nm001070', 'nm001071', 'nm001072', 'nm001073', 'nm001074', 'nm001075', 'nm001076', 'nm001077', 'nm001078', 'nm001079', 'nm001080', 'nm001081', 'nm001082', 'nm001083', 'nm001084', 'nm001085', 'nm001086', 'nm001087', 'nm001088', 'nm001089', 'nm001090', 'nm001091', 'nm001092', 'nm001093', 'nm001094', 'nm001095', 'nm001096', 'nm001097', 'nm001098', 'nm001099', 'nm001100', 'nm001101', 'nm001102', 'nm001103', 'nm001104', 'nm001105', 'nm001106', 'nm001107', 'nm001108', 'nm001109', 'nm001110', 'nm001111', 'nm001112', 'nm001113', 'nm001114', 'nm001115', 'nm001116', 'nm001117', 'nm001118', 'nm001119', 'nm001120', 'nm001121', 'nm001122', 'nm001123', 'nm001124', 'nm001125', 'nm001126', 'nm001127', 'nm001128', 'nm001129', 'nm001130', 'nm001131', 'nm001132', 'nm001133', 'nm001134', 'nm001135', 'nm001136', 'nm001137', 'nm001138', 'nm001139', 'nm001140', 'nm001141', 'nm001142', 'nm001143', 'nm001144', 'nm001145', 'nm001146', 'nm001147', 'nm001148', 'nm001149', 'nm001150', 'nm001151', 'nm001152', 'nm001153', 'nm001154', 'nm001155', 'nm001156', 'nm001157', 'nm001158', 'nm001159', 'nm001160', 'nm001161', 'nm001162', 'nm001163', 'nm001164', 'nm001165', 'nm001166', 'nm001167', 'nm001168', 'nm001169', 'nm001170', 'nm001171', 'nm001172', 'nm001173', 'nm001174', 'nm001175', 'nm001176', 'nm001177', 'nm001178', 'nm001179', 'nm001180', 'nm001181', 'nm001182', 'nm001183', 'nm001184', 'nm001185', 'nm001186', 'nm001187', 'nm001188', 'nm001189', 'nm001190', 'nm001191', 'nm001192', 'nm001193', 'nm001194', 'nm001195', 'nm001196', 'nm001197', 'nm001198', 'nm001199', 'nm001200', 'nm001201', 'nm001202', 'nm001203', 'nm001204', 'nm001205', 'nm001206', 'nm001207', 'nm001208', 'nm001209', 'nm001210', 'nm001211', 'nm001212', 'nm001213', 'nm001214', 'nm001215', 'nm001216', 'nm001217', 'nm001218', 'nm001219', 'nm001220', 'nm001221', 'nm001222', 'nm001223', 'nm001224', 'nm001225', 'nm001226', 'nm001227', 'nm001228', 'nm001229', 'nm001230', 'nm001231', 'nm001232', 'nm001233', 'nm001234', 'nm001235', 'nm001236', 'nm001237', 'nm001238', 'nm001239', 'nm001240', 'nm001241', 'nm001242', 'nm001243', 'nm001244', 'nm001245', 'nm001246', 'nm001247', 'nm001248', 'nm001249', 'nm001250', 'nm001251', 'nm001252', 'nm001253', 'nm001254', 'nm001255', 'nm001256', 'nm001257', 'nm001258', 'nm001259', 'nm001260', 'nm001261', 'nm001262', 'nm001263', 'nm001264', 'nm001265', 'nm001266', 'nm001267', 'nm001268', 'nm001269', 'nm001270', 'nm001271', 'nm001272', 'nm001273', 'nm001274', 'nm001275', 'nm001276', 'nm001277', 'nm001278', 'nm001279', 'nm001280', 'nm001281', 'nm001282', 'nm001283', 'nm001284', 'nm001285', 'nm001286', 'nm001287', 'nm001288', 'nm001289', 'nm001290', 'nm001291', 'nm001292', 'nm001293', 'nm001294', 'nm001295', 'nm001296', 'nm001297', 'nm001298', 'nm001299', 'nm001300', 'nm001301', 'nm001302', 'nm001303', 'nm001304', 'nm001305', 'nm001306', 'nm001307', 'nm001308', 'nm001309', 'nm001310', 'nm001311', 'nm001312', 'nm001313', 'nm001314', 'nm001315', 'nm001316', 'nm001317', 'nm001318', 'nm001319', 'nm001320', 'nm001321', 'nm001322', 'nm001323', 'nm001324', 'nm001325', 'nm001326', 'nm001327', 'nm001328', 'nm001329', 'nm001330', 'nm001331', 'nm001332', 'nm001333', 'nm001334', 'nm001335', 'nm001336', 'nm001337', 'nm001338', 'nm001339', 'nm001340', 'nm001341', 'nm001342', 'nm001343', 'nm001344', 'nm001345', 'nm001346', 'nm001347', 'nm001348', 'nm001349', 'nm001350', 'nm001351', 'nm001352', 'nm001353', 'nm001354', 'nm001355', 'nm001356', 'nm001357', 'nm001358', 'nm001359', 'nm001360', 'nm001361', 'nm001362', 'nm001363', 'nm001364', 'nm001365', 'nm001366', 'nm001367', 'nm001368', 'nm001369', 'nm001370', 'nm001371', 'nm001372', 'nm001373', 'nm001374', 'nm001375', 'nm001376', 'nm001377', 'nm001378', 'nm001379', 'nm001380', 'nm001381', 'nm001382', 'nm001383', 'nm001384', 'nm001385', 'nm001386', 'nm001387', 'nm001388', 'nm001389', 'nm001390', 'nm001391', 'nm001392', 'nm001393', 'nm001394', 'nm001395', 'nm001396', 'nm001397', 'nm001398', 'nm001399', 'nm001400', 'nm001401', 'nm001402', 'nm001403', 'nm001404', 'nm001405', 'nm001406', 'nm001407', 'nm001408', 'nm001409', 'nm001410', 'nm001411', 'nm001412', 'nm001413', 'nm001414', 'nm001415', 'nm001416', 'nm001417', 'nm001418', 'nm001419', 'nm001420', 'nm001421', 'nm001422', 'nm001423', 'nm001424', 'nm001425', 'nm001426', 'nm001427', 'nm001428', 'nm001429', 'nm001430', 'nm001431', 'nm001432', 'nm001433', 'nm001434', 'nm001435', 'nm001436', 'nm001437', 'nm001438', 'nm001439', 'nm001440', 'nm001441', 'nm001442', 'nm001443', 'nm001444', 'nm001445', 'nm001446', 'nm001447', 'nm001448', 'nm001449', 'nm001450', 'nm001451', 'nm001452', 'nm001453', 'nm001454', 'nm001455', 'nm001456', 'nm001457', 'nm001458', 'nm001459', 'nm001460', 'nm001461', 'nm001462', 'nm001463', 'nm001464', 'nm001465', 'nm001466', 'nm001467', 'nm001468', 'nm001469', 'nm001470', 'nm001471', 'nm001472', 'nm001473', 'nm001474', 'nm001475', 'nm001476', 'nm001477', 'nm001478', 'nm001479', 'nm001480', 'nm001481', 'nm001482', 'nm001483', 'nm001484', 'nm001485', 'nm001486', 'nm001487', 'nm001488', 'nm001489', 'nm001490', 'nm001491', 'nm001492', 'nm001493', 'nm001494', 'nm001495', 'nm001496', 'nm001497', 'nm001498', 'nm001499', 'nm001500', 'nm001501', 'nm001502', 'nm001503', 'nm001504', 'nm001505', 'nm001506', 'nm001507', 'nm001508', 'nm001509', 'nm001510', 'nm001511', 'nm001512', 'nm001513', 'nm001514', 'nm001515', 'nm001516', 'nm001517', 'nm001518', 'nm001519', 'nm001520', 'nm001521', 'nm001522', 'nm001523', 'nm001524', 'nm001525', 'nm001526', 'nm001527', 'nm001528', 'nm001529', 'nm001530', 'nm001531', 'nm001532', 'nm001533', 'nm001534', 'nm001535', 'nm001536', 'nm001537', 'nm001538', 'nm001539', 'nm001540', 'nm001541', 'nm001542', 'nm001543', 'nm001544', 'nm001545', 'nm001546', 'nm001547', 'nm001548', 'nm001549', 'nm001550', 'nm001551', 'nm001552', 'nm001553', 'nm001554', 'nm001555', 'nm001556', 'nm001557', 'nm001558', 'nm001559', 'nm001560', 'nm001561', 'nm001562', 'nm001563', 'nm001564', 'nm001565', 'nm001566', 'nm001567', 'nm001568', 'nm001569', 'nm001570', 'nm001571', 'nm001572', 'nm001573', 'nm001574', 'nm001575', 'nm001576', 'nm001577', 'nm001578', 'nm001579', 'nm001580', 'nm001581', 'nm001582', 'nm001583', 'nm001584', 'nm001585', 'nm001586', 'nm001587', 'nm001588', 'nm001589', 'nm001590', 'nm001591', 'nm001592', 'nm001593', 'nm001594', 'nm001595', 'nm001596', 'nm001597', 'nm001598', 'nm001599', 'nm001600', 'nm001601', 'nm001602', 'nm001603', 'nm001604', 'nm001605', 'nm001606', 'nm001607', 'nm001608', 'nm001609', 'nm001610', 'nm001611', 'nm001612', 'nm001613', 'nm001614', 'nm001615', 'nm001616', 'nm001617', 'nm001618', 'nm001619', 'nm001620', 'nm001621', 'nm001622', 'nm001623', 'nm001624', 'nm001625', 'nm001626', 'nm001627', 'nm001628', 'nm001629', 'nm001630', 'nm001631', 'nm001632', 'nm001633', 'nm001634', 'nm001635', 'nm001636', 'nm001637', 'nm001638', 'nm001639', 'nm001640', 'nm001641', 'nm001642', 'nm001643', 'nm001644', 'nm001645', 'nm001646', 'nm001647', 'nm001648', 'nm001649', 'nm001650', 'nm001651', 'nm001652', 'nm001653', 'nm001654', 'nm001655', 'nm001656', 'nm001657', 'nm001658', 'nm001659', 'nm001660', 'nm001661', 'nm001662', 'nm001663', 'nm001664', 'nm001665', 'nm001666', 'nm001667', 'nm001668', 'nm001669', 'nm001670', 'nm001671', 'nm001672', 'nm001673', 'nm001674', 'nm001675', 'nm001676', 'nm001677', 'nm001678', 'nm001679', 'nm001680', 'nm001681', 'nm001682', 'nm001683', 'nm001684', 'nm001685', 'nm001686', 'nm001687', 'nm001688', 'nm001689', 'nm001690', 'nm001691', 'nm001692', 'nm001693', 'nm001694', 'nm001695', 'nm001696', 'nm001697', 'nm001698', 'nm001699', 'nm001700', 'nm001701', 'nm001702', 'nm001703', 'nm001704', 'nm001705', 'nm001706', 'nm001707', 'nm001708', 'nm001709', 'nm001710', 'nm001711', 'nm001712', 'nm001713', 'nm001714', 'nm001715', 'nm001716', 'nm001717', 'nm001718', 'nm001719', 'nm001720', 'nm001721', 'nm001722', 'nm001723', 'nm001724', 'nm001725', 'nm001726', 'nm001727', 'nm001728', 'nm001729', 'nm001730', 'nm001731', 'nm001732', 'nm001733', 'nm001734', 'nm001735', 'nm001736', 'nm001737', 'nm001738', 'nm001739', 'nm001740', 'nm001741', 'nm001742', 'nm001743', 'nm001744', 'nm001745', 'nm001746', 'nm001747', 'nm001748', 'nm001749', 'nm001750', 'nm001751', 'nm001752', 'nm001753', 'nm001754', 'nm001755', 'nm001756', 'nm001757', 'nm001758', 'nm001759', 'nm001760', 'nm001761', 'nm001762', 'nm001763', 'nm001764', 'nm001765', 'nm001766', 'nm001767', 'nm001768', 'nm001769', 'nm001770', 'nm001771', 'nm001772', 'nm001773', 'nm001774', 'nm001775', 'nm001776', 'nm001777', 'nm001778', 'nm001779', 'nm001780', 'nm001781', 'nm001782', 'nm001783', 'nm001784', 'nm001785', 'nm001786', 'nm001787', 'nm001788', 'nm001789', 'nm001790', 'nm001791', 'nm001792', 'nm001793', 'nm001794', 'nm001795', 'nm001796', 'nm001797', 'nm001798', 'nm001799', 'nm001800', 'nm001801', 'nm001802', 'nm001803', 'nm001804', 'nm001805', 'nm001806', 'nm001807', 'nm001808', 'nm001809', 'nm001810', 'nm001811', 'nm001812', 'nm001813', 'nm001814', 'nm001815', 'nm001816', 'nm001817', 'nm001818', 'nm001819', 'nm001820', 'nm001821', 'nm001822', 'nm001823', 'nm001824', 'nm001825', 'nm001826', 'nm001827', 'nm001828', 'nm001829', 'nm001830', 'nm001831', 'nm001832', 'nm001833', 'nm001834', 'nm001835', 'nm001836', 'nm001837', 'nm001838', 'nm001839', 'nm001840', 'nm001841', 'nm001842', 'nm001843', 'nm001844', 'nm001845', 'nm001846', 'nm001847', 'nm001848', 'nm001849', 'nm001850', 'nm001851', 'nm001852', 'nm001853', 'nm001854', 'nm001855', 'nm001856', 'nm001857', 'nm001858', 'nm001859', 'nm001860', 'nm001861', 'nm001862', 'nm001863', 'nm001864', 'nm001865', 'nm001866', 'nm001867', 'nm001868', 'nm001869', 'nm001870', 'nm001871', 'nm001872', 'nm001873', 'nm001874', 'nm001875', 'nm001876', 'nm001877', 'nm001878', 'nm001879', 'nm001880', 'nm001881', 'nm001882', 'nm001883', 'nm001884', 'nm001885', 'nm001886', 'nm001887', 'nm001888', 'nm001889', 'nm001890', 'nm001891', 'nm001892', 'nm001893', 'nm001894', 'nm001895', 'nm001896', 'nm001897', 'nm001898', 'nm001899', 'nm001900', 'nm001901', 'nm001902', 'nm001903', 'nm001904', 'nm001905', 'nm001906', 'nm001907', 'nm001908', 'nm001909', 'nm001910', 'nm001911', 'nm001912', 'nm001913', 'nm001914', 'nm001915', 'nm001916', 'nm001917', 'nm001918', 'nm001919', 'nm001920', 'nm001921', 'nm001922', 'nm001923', 'nm001924', 'nm001925', 'nm001926', 'nm001927', 'nm001928', 'nm001929', 'nm001930', 'nm001931', 'nm001932', 'nm001933', 'nm001934', 'nm001935', 'nm001936', 'nm001937', 'nm001938', 'nm001939', 'nm001940', 'nm001941', 'nm001942', 'nm001943', 'nm001944', 'nm001945', 'nm001946', 'nm001947', 'nm001948', 'nm001949', 'nm001950', 'nm001951', 'nm001952', 'nm001953', 'nm001954', 'nm001955', 'nm001956', 'nm001957', 'nm001958', 'nm001959', 'nm001960', 'nm001961', 'nm001962', 'nm001963', 'nm001964', 'nm001965', 'nm001966', 'nm001967', 'nm001968', 'nm001969', 'nm001970', 'nm001971', 'nm001972', 'nm001973', 'nm001974', 'nm001975', 'nm001976', 'nm001977', 'nm001978', 'nm001979', 'nm001980', 'nm001981', 'nm001982', 'nm001983', 'nm001984', 'nm001985', 'nm001986', 'nm001987', 'nm001988', 'nm001989', 'nm001990', 'nm001991', 'nm001992', 'nm001993', 'nm001994', 'nm001995', 'nm001996', 'nm001997', 'nm001998', 'nm001999', 'nm002000', 'nm002001', 'nm002002', 'nm002003', 'nm002004', 'nm002005', 'nm002006', 'nm002007', 'nm002008', 'nm002009', 'nm002010', 'nm002011', 'nm002012', 'nm002013', 'nm002014', 'nm002015', 'nm002016', 'nm002017', 'nm002018', 'nm002019', 'nm002020', 'nm002021', 'nm002022', 'nm002023', 'nm002024', 'nm002025', 'nm002026', 'nm002027', 'nm002028', 'nm002029', 'nm002030', 'nm002031', 'nm002032', 'nm002033', 'nm002034', 'nm002035', 'nm002036', 'nm002037', 'nm002038', 'nm002039', 'nm002040', 'nm002041', 'nm002042', 'nm002043', 'nm002044', 'nm002045', 'nm002046', 'nm002047', 'nm002048', 'nm002049', 'nm002050', 'nm002051', 'nm002052', 'nm002053', 'nm002054', 'nm002055', 'nm002056', 'nm002057', 'nm002058', 'nm002059', 'nm002060', 'nm002061', 'nm002062', 'nm002063', 'nm002064', 'nm002065', 'nm002066', 'nm002067', 'nm002068', 'nm002069', 'nm002070', 'nm002071', 'nm002072', 'nm002073', 'nm002074', 'nm002075', 'nm002076', 'nm002077', 'nm002078', 'nm002079', 'nm002080', 'nm002081', 'nm002082', 'nm002083', 'nm002084', 'nm002085', 'nm002086', 'nm002087', 'nm002088', 'nm002089', 'nm002090', 'nm002091', 'nm002092', 'nm002093', 'nm002094', 'nm002095', 'nm002096', 'nm002097', 'nm002098', 'nm002099', 'nm002100', 'nm002101', 'nm002102', 'nm002103', 'nm002104', 'nm002105', 'nm002106', 'nm002107', 'nm002108', 'nm002109', 'nm002110', 'nm002111', 'nm002112', 'nm002113', 'nm002114', 'nm002115', 'nm002116', 'nm002117', 'nm002118', 'nm002119', 'nm002120', 'nm002121', 'nm002122', 'nm002123', 'nm002124', 'nm002125', 'nm002126', 'nm002127', 'nm002128', 'nm002129', 'nm002130', 'nm002131', 'nm002132', 'nm002133', 'nm002134', 'nm002135', 'nm002136', 'nm002137', 'nm002138', 'nm002139', 'nm002140', 'nm002141', 'nm002142', 'nm002143', 'nm002144', 'nm002145', 'nm002146', 'nm002147', 'nm002148', 'nm002149', 'nm002150', 'nm002151', 'nm002152', 'nm002153', 'nm002154', 'nm002155', 'nm002156', 'nm002157', 'nm002158', 'nm002159', 'nm002160', 'nm002161', 'nm002162', 'nm002163', 'nm002164', 'nm002165', 'nm002166', 'nm002167', 'nm002168', 'nm002169', 'nm002170', 'nm002171', 'nm002172', 'nm002173', 'nm002174', 'nm002175', 'nm002176', 'nm002177', 'nm002178', 'nm002179', 'nm002180', 'nm002181', 'nm002182', 'nm002183', 'nm002184', 'nm002185', 'nm002186', 'nm002187', 'nm002188', 'nm002189', 'nm002190', 'nm002191', 'nm002192', 'nm002193', 'nm002194', 'nm002195', 'nm002196', 'nm002197', 'nm002198', 'nm002199', 'nm002200', 'nm002201', 'nm002202', 'nm002203', 'nm002204', 'nm002205', 'nm002206', 'nm002207', 'nm002208', 'nm002209', 'nm002210', 'nm002211', 'nm002212', 'nm002213', 'nm002214', 'nm002215', 'nm002216', 'nm002217', 'nm002218', 'nm002219', 'nm002220', 'nm002221', 'nm002222', 'nm002223', 'nm002224', 'nm002225', 'nm002226', 'nm002227', 'nm002228', 'nm002229', 'nm002230', 'nm002231', 'nm002232', 'nm002233', 'nm002234', 'nm002235', 'nm002236', 'nm002237', 'nm002238', 'nm002239', 'nm002240', 'nm002241', 'nm002242', 'nm002243', 'nm002244', 'nm002245', 'nm002246', 'nm002247', 'nm002248', 'nm002249', 'nm002250', 'nm002251', 'nm002252', 'nm002253', 'nm002254', 'nm002255', 'nm002256', 'nm002257', 'nm002258', 'nm002259', 'nm002260', 'nm002261', 'nm002262', 'nm002263', 'nm002264', 'nm002265', 'nm002266', 'nm002267', 'nm002268', 'nm002269', 'nm002270', 'nm002271', 'nm002272', 'nm002273', 'nm002274', 'nm002275', 'nm002276', 'nm002277', 'nm002278', 'nm002279', 'nm002280', 'nm002281', 'nm002282', 'nm002283', 'nm002284', 'nm002285', 'nm002286', 'nm002287', 'nm002288', 'nm002289', 'nm002290', 'nm002291', 'nm002292', 'nm002293', 'nm002294', 'nm002295', 'nm002296', 'nm002297', 'nm002298', 'nm002299', 'nm002300', 'nm002301', 'nm002302', 'nm002303', 'nm002304', 'nm002305', 'nm002306', 'nm002307', 'nm002308', 'nm002309', 'nm002310', 'nm002311', 'nm002312', 'nm002313', 'nm002314', 'nm002315', 'nm002316', 'nm002317', 'nm002318', 'nm002319', 'nm002320', 'nm002321', 'nm002322', 'nm002323', 'nm002324', 'nm002325', 'nm002326', 'nm002327', 'nm002328', 'nm002329', 'nm002330', 'nm002331', 'nm002332', 'nm002333', 'nm002334', 'nm002335', 'nm002336', 'nm002337', 'nm002338', 'nm002339', 'nm002340', 'nm002341', 'nm002342', 'nm002343', 'nm002344', 'nm002345', 'nm002346', 'nm002347', 'nm002348', 'nm002349', 'nm002350', 'nm002351', 'nm002352', 'nm002353', 'nm002354', 'nm002355', 'nm002356', 'nm002357', 'nm002358', 'nm002359', 'nm002360', 'nm002361', 'nm002362', 'nm002363', 'nm002364', 'nm002365', 'nm002366', 'nm002367', 'nm002368', 'nm002369', 'nm002370', 'nm002371', 'nm002372', 'nm002373', 'nm002374', 'nm002375', 'nm002376', 'nm002377', 'nm002378', 'nm002379', 'nm002380', 'nm002381', 'nm002382', 'nm002383', 'nm002384', 'nm002385', 'nm002386', 'nm002387', 'nm002388', 'nm002389', 'nm002390', 'nm002391', 'nm002392', 'nm002393', 'nm002394', 'nm002395', 'nm002396', 'nm002397', 'nm002398', 'nm002399', 'nm002400', 'nm002401', 'nm002402', 'nm002403', 'nm002404', 'nm002405', 'nm002406', 'nm002407', 'nm002408', 'nm002409', 'nm002410', 'nm002411', 'nm002412', 'nm002413', 'nm002414', 'nm002415', 'nm002416', 'nm002417', 'nm002418', 'nm002419', 'nm002420', 'nm002421', 'nm002422', 'nm002423', 'nm002424', 'nm002425', 'nm002426', 'nm002427', 'nm002428', 'nm002429', 'nm002430', 'nm002431', 'nm002432', 'nm002433', 'nm002434', 'nm002435', 'nm002436', 'nm002437', 'nm002438', 'nm002439', 'nm002440', 'nm002441', 'nm002442', 'nm002443', 'nm002444', 'nm002445', 'nm002446', 'nm002447', 'nm002448', 'nm002449', 'nm002450', 'nm002451', 'nm002452', 'nm002453', 'nm002454', 'nm002455', 'nm002456', 'nm002457', 'nm002458', 'nm002459', 'nm002460', 'nm002461', 'nm002462', 'nm002463', 'nm002464', 'nm002465', 'nm002466', 'nm002467', 'nm002468', 'nm002469', 'nm002470', 'nm002471', 'nm002472', 'nm002473', 'nm002474', 'nm002475', 'nm002476', 'nm002477', 'nm002478', 'nm002479', 'nm002480', 'nm002481', 'nm002482', 'nm002483', 'nm002484', 'nm002485', 'nm002486', 'nm002487', 'nm002488', 'nm002489', 'nm002490', 'nm002491', 'nm002492', 'nm002493', 'nm002494', 'nm002495', 'nm002496', 'nm002497', 'nm002498', 'nm002499', 'nm002500', 'nm002501', 'nm002502', 'nm002503', 'nm002504', 'nm002505', 'nm002506', 'nm002507', 'nm002508', 'nm002509', 'nm002510', 'nm002511', 'nm002512', 'nm002513', 'nm002514', 'nm002515', 'nm002516', 'nm002517', 'nm002518', 'nm002519', 'nm002520', 'nm002521', 'nm002522', 'nm002523', 'nm002524', 'nm002525', 'nm002526', 'nm002527', 'nm002528', 'nm002529', 'nm002530', 'nm002531', 'nm002532', 'nm002533', 'nm002534', 'nm002535', 'nm002536', 'nm002537', 'nm002538', 'nm002539', 'nm002540', 'nm002541', 'nm002542', 'nm002543', 'nm002544', 'nm002545', 'nm002546', 'nm002547', 'nm002548', 'nm002549', 'nm002550', 'nm002551', 'nm002552', 'nm002553', 'nm002554', 'nm002555', 'nm002556', 'nm002557', 'nm002558', 'nm002559', 'nm002560', 'nm002561', 'nm002562', 'nm002563', 'nm002564', 'nm002565', 'nm002566', 'nm002567', 'nm002568', 'nm002569', 'nm002570', 'nm002571', 'nm002572', 'nm002573', 'nm002574', 'nm002575', 'nm002576', 'nm002577', 'nm002578', 'nm002579', 'nm002580', 'nm002581', 'nm002582', 'nm002583', 'nm002584', 'nm002585', 'nm002586', 'nm002587', 'nm002588', 'nm002589', 'nm002590', 'nm002591', 'nm002592', 'nm002593', 'nm002594', 'nm002595', 'nm002596', 'nm002597', 'nm002598', 'nm002599', 'nm002600', 'nm002601', 'nm002602', 'nm002603', 'nm002604', 'nm002605', 'nm002606', 'nm002607', 'nm002608', 'nm002609', 'nm002610', 'nm002611', 'nm002612', 'nm002613', 'nm002614', 'nm002615', 'nm002616', 'nm002617', 'nm002618', 'nm002619', 'nm002620', 'nm002621', 'nm002622', 'nm002623', 'nm002624', 'nm002625', 'nm002626', 'nm002627', 'nm002628', 'nm002629', 'nm002630', 'nm002631', 'nm002632', 'nm002633', 'nm002634', 'nm002635', 'nm002636', 'nm002637', 'nm002638', 'nm002639', 'nm002640', 'nm002641', 'nm002642', 'nm002643', 'nm002644', 'nm002645', 'nm002646', 'nm002647', 'nm002648', 'nm002649', 'nm002650', 'nm002651', 'nm002652', 'nm002653', 'nm002654', 'nm002655', 'nm002656', 'nm002657', 'nm002658', 'nm002659', 'nm002660', 'nm002661', 'nm002662', 'nm002663', 'nm002664', 'nm002665', 'nm002666', 'nm002667', 'nm002668', 'nm002669', 'nm002670', 'nm002671', 'nm002672', 'nm002673', 'nm002674', 'nm002675', 'nm002676', 'nm002677', 'nm002678', 'nm002679', 'nm002680', 'nm002681', 'nm002682', 'nm002683', 'nm002684', 'nm002685', 'nm002686', 'nm002687', 'nm002688', 'nm002689', 'nm002690', 'nm002691', 'nm002692', 'nm002693', 'nm002694', 'nm002695', 'nm002696', 'nm002697', 'nm002698', 'nm002699', 'nm002700', 'nm002701', 'nm002702', 'nm002703', 'nm002704', 'nm002705', 'nm002706', 'nm002707', 'nm002708', 'nm002709', 'nm002710', 'nm002711', 'nm002712', 'nm002713', 'nm002714', 'nm002715', 'nm002716', 'nm002717', 'nm002718', 'nm002719', 'nm002720', 'nm002721', 'nm002722', 'nm002723', 'nm002724', 'nm002725', 'nm002726', 'nm002727', 'nm002728', 'nm002729', 'nm002730', 'nm002731', 'nm002732', 'nm002733', 'nm002734', 'nm002735', 'nm002736', 'nm002737', 'nm002738', 'nm002739', 'nm002740', 'nm002741', 'nm002742', 'nm002743', 'nm002744', 'nm002745', 'nm002746', 'nm002747', 'nm002748', 'nm002749', 'nm002750', 'nm002751', 'nm002752', 'nm002753', 'nm002754', 'nm002755', 'nm002756', 'nm002757', 'nm002758', 'nm002759', 'nm002760', 'nm002761', 'nm002762', 'nm002763', 'nm002764', 'nm002765', 'nm002766', 'nm002767', 'nm002768', 'nm002769', 'nm002770', 'nm002771', 'nm002772', 'nm002773', 'nm002774', 'nm002775', 'nm002776', 'nm002777', 'nm002778', 'nm002779', 'nm002780', 'nm002781', 'nm002782', 'nm002783', 'nm002784', 'nm002785', 'nm002786', 'nm002787', 'nm002788', 'nm002789', 'nm002790', 'nm002791', 'nm002792', 'nm002793', 'nm002794', 'nm002795', 'nm002796', 'nm002797', 'nm002798', 'nm002799', 'nm002800', 'nm002801', 'nm002802', 'nm002803', 'nm002804', 'nm002805', 'nm002806', 'nm002807', 'nm002808', 'nm002809', 'nm002810', 'nm002811', 'nm002812', 'nm002813', 'nm002814', 'nm002815', 'nm002816', 'nm002817', 'nm002818', 'nm002819', 'nm002820', 'nm002821', 'nm002822', 'nm002823', 'nm002824', 'nm002825', 'nm002826', 'nm002827', 'nm002828', 'nm002829', 'nm002830', 'nm002831', 'nm002832', 'nm002833', 'nm002834', 'nm002835', 'nm002836', 'nm002837', 'nm002838', 'nm002839', 'nm002840', 'nm002841', 'nm002842', 'nm002843', 'nm002844', 'nm002845', 'nm002846', 'nm002847', 'nm002848', 'nm002849', 'nm002850', 'nm002851', 'nm002852', 'nm002853', 'nm002854', 'nm002855', 'nm002856', 'nm002857', 'nm002858', 'nm002859', 'nm002860', 'nm002861', 'nm002862', 'nm002863', 'nm002864', 'nm002865', 'nm002866', 'nm002867', 'nm002868', 'nm002869', 'nm002870', 'nm002871', 'nm002872', 'nm002873', 'nm002874', 'nm002875', 'nm002876', 'nm002877', 'nm002878', 'nm002879', 'nm002880', 'nm002881', 'nm002882', 'nm002883', 'nm002884', 'nm002885', 'nm002886', 'nm002887', 'nm002888', 'nm002889', 'nm002890', 'nm002891', 'nm002892', 'nm002893', 'nm002894', 'nm002895', 'nm002896', 'nm002897', 'nm002898', 'nm002899', 'nm002900', 'nm002901', 'nm002902', 'nm002903', 'nm002904', 'nm002905', 'nm002906', 'nm002907', 'nm002908', 'nm002909', 'nm002910', 'nm002911', 'nm002912', 'nm002913', 'nm002914', 'nm002915', 'nm002916', 'nm002917', 'nm002918', 'nm002919', 'nm002920', 'nm002921', 'nm002922', 'nm002923', 'nm002924', 'nm002925', 'nm002926', 'nm002927', 'nm002928', 'nm002929', 'nm002930', 'nm002931', 'nm002932', 'nm002933', 'nm002934', 'nm002935', 'nm002936', 'nm002937', 'nm002938', 'nm002939', 'nm002940', 'nm002941', 'nm002942', 'nm002943', 'nm002944', 'nm002945', 'nm002946', 'nm002947', 'nm002948', 'nm002949', 'nm002950', 'nm002951', 'nm002952', 'nm002953', 'nm002954', 'nm002955', 'nm002956', 'nm002957', 'nm002958', 'nm002959', 'nm002960', 'nm002961', 'nm002962', 'nm002963', 'nm002964', 'nm002965', 'nm002966', 'nm002967', 'nm002968', 'nm002969', 'nm002970', 'nm002971', 'nm002972', 'nm002973', 'nm002974', 'nm002975', 'nm002976', 'nm002977', 'nm002978', 'nm002979', 'nm002980', 'nm002981', 'nm002982', 'nm002983', 'nm002984', 'nm002985', 'nm002986', 'nm002987', 'nm002988', 'nm002989', 'nm002990', 'nm002991', 'nm002992', 'nm002993', 'nm002994', 'nm002995', 'nm002996', 'nm002997', 'nm002998', 'nm002999']
        query_1_person = " MATCH (p:Person {{id: '{}'}}) RETURN p"
        lis = [query_1_person.format(the_id) for the_id in person_ids]
        return lis

    def generate_movie_queries():
        movie_ids = ["tt9792510", "tt9792512", "tt9792514", "tt9792518", "tt9792520", "tt9792524", "tt9792526", "tt9792528", "tt9792530", "tt9792532", "tt9792534", "tt9792538", "tt9792540", "tt9792542", "tt9792544", "tt9792548", "tt9792550", "tt9792552", "tt9792554", "tt9792558", "tt9792560", "tt9792562", "tt9792564", "tt9792566", "tt9792568", "tt9792570", "tt9792572", "tt9792574", "tt9792576", "tt9792578"]
        query_1_movie = " MATCH (m:Movie {{id: '{}'}}) RETURN m"
        lis = [query_1_movie.format(the_id) for the_id in movie_ids]
        return lis

    queries = []
    queries += generate_person_queries()
    queries += generate_movie_queries()
    print(len(queries))

    t1 = time.time()
    # Test with one replica
    replica_connector_1 = Neo4jConnector(primary_uri, user, password)
    print("Querying using a single node:")
    with ThreadPoolExecutor() as executor:
        futures_replica_1 = [
            executor.submit(run, replica_connector_1, query) for query in queries
        ]
        [future.result() for future in futures_replica_1]
    t2 = time.time()
    print(f"Time: {t2-t1:.2f}s")
    # Test with two replicas
    print("Querying using the cluster:")
    replica_connector_2 = Neo4jConnector(cluster_uri, user, password)
    with ThreadPoolExecutor() as executor:
        futures_replica_1 = [
            executor.submit(run, replica_connector_2, query) for query in queries
        ]
        [future.result() for future in futures_replica_1]
    t3 = time.time()
    print(f"Time: {t3-t2:.2f}s")


if __name__ == "__main__":
    test_query_performance()
